# 预处理 # 
脑电图（EEG）预处理是分析 EEG 信号的重要步骤，旨在去除噪声和伪影，增强信号质量，从而更准确地进行后续`分析`。 <font color=red>内容</font>

## 滤波
注意滤波操作一定要在降频分析之前：如果在降频之前不进行低通滤波，高于新采样率一半的频率成分将会混入低频部分，导致无法正确重建原始信号的频率特性。  
<details>
<summary>滤波器</summary> 
数字滤波器在信号处理中扮演着重要角色，它们用于修改或增强信号中的某些特征。数字滤波器通过在时域或频域中对数字信号进行数学操作来实现这一目的。  
注：我们在这里讲的都是数字滤波器   
  
##### 有限脉冲响应（FIR）滤波器
FIR滤波器的输出仅依赖于当前和过去的输入值。它们的脉冲响应是有限的，即当输入为单位脉冲时，滤波器的输出在有限时间内变为零。  
$\[ y[n] = \sum_{k=0}^{N} b[k] \cdot x[n-k] \]$

其中，( b[k] \) 是滤波器的系数，\( N \) 是滤波器的阶数，\( x[n] \) 是输入信号，\( y[n] \) 是输出信号。


**优点：**
- 固有的线性相位响应：这意味着所有频率成分的相位延迟相同，不会引起信号波形的畸变。
- 稳定性：FIR滤波器总是稳定的，因为其多项式的所有零点都在单位圆上。

**缺点：**
- 对于相同的滤波器性能，FIR滤波器通常需要更多的计算资源和更高的阶数。
- 设计复杂度：为了达到与 IIR 滤波器相同的频率选择性，FIR 滤波器的阶数通常要高得多。
##### 无限脉冲响应（IIR）滤波器

**工作原理**

IIR 滤波器的输出依赖于当前和过去的输入值以及过去的输出值。它们的脉冲响应是无限的，即当输入为单位脉冲时，滤波器的输出在无限时间内趋近于零。IIR 滤波器的数学表达式为：  
$\[ y[n] = \sum_{k=0}^{N} b[k] \cdot x[n-k] - \sum_{j=1}^{M} a[j] \cdot y[n-j] \]$  

其中，\( b[k] \) 和 \( a[j] \) 是滤波器的系数，\( N \) 和 \( M \) 分别是输入和输出的阶数，\( x[n] \) 是输入信号，\( y[n] \) 是输出信号。

**优点**

- **效率高**：IIR 滤波器可以用较低的阶数达到与 FIR 滤波器相同的滤波效果。
- **计算资源需求低**：由于阶数较低，IIR 滤波器的计算开销较小。

**缺点**

- **潜在的不稳定性**：如果设计不当，IIR 滤波器可能会不稳定。
- **非线性相位响应**：可能会引起信号波形的畸变。

**应用**

IIR 滤波器广泛应用于对相位响应要求不高的场合，如音频处理、振动分析和通信系统等。

</details>

### 带通滤波
对原始数据进行滤波处理：先以 0.5Hz的频率对脑电图信号进行高通滤波，以去除任何DC分量。接着，用低通滤波器衰减脑电信号的高频噪声。由于脑波活动的相关频带在 1Hz~32Hz 的范围内，我们将低通滤波器的通带是向上设计到35Hz，高通滤波器的通带设计到0.5Hz。  
### 去除工频干扰
此外实验中还采用陷波滤波器过滤掉50Hz电源的工频干扰。它们能够精确地去除特定频率的干扰而不损失EEG信号中的其他有用成分。
